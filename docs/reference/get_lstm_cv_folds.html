<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Cross-Validation Split for LSTM Environmental Suitability Models — get_lstm_cv_folds • MOSAIC</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Cross-Validation Split for LSTM Environmental Suitability Models — get_lstm_cv_folds"><meta name="description" content="This function creates train/validation splits for LSTM training using three different
cross-validation strategies: random sampling, spatial leave-one-out, or temporal cutoff.
Each approach provides different insights into model generalization capability for
cholera environmental suitability prediction."><meta property="og:description" content="This function creates train/validation splits for LSTM training using three different
cross-validation strategies: random sampling, spatial leave-one-out, or temporal cutoff.
Each approach provides different insights into model generalization capability for
cholera environmental suitability prediction."><meta property="og:image" content="https://institutefordiseasemodeling.github.io/MOSAIC-pkg/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MOSAIC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.13.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/Running-LASER.html">Running LASER</a></li>
    <li><a class="dropdown-item" href="../articles/Running-MOSAIC.html">Running MOSAIC</a></li>
    <li><a class="dropdown-item" href="../articles/Deployment.html">Deployment</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/InstituteforDiseaseModeling/MOSAIC-pkg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate Cross-Validation Split for LSTM Environmental Suitability Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/InstituteforDiseaseModeling/MOSAIC-pkg/blob/HEAD/R/get_lstm_cv_folds.R" class="external-link"><code>R/get_lstm_cv_folds.R</code></a></small>
      <div class="d-none name"><code>get_lstm_cv_folds.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates train/validation splits for LSTM training using three different
cross-validation strategies: random sampling, spatial leave-one-out, or temporal cutoff.
Each approach provides different insights into model generalization capability for
cholera environmental suitability prediction.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_lstm_cv_folds</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  cv_mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"random"</span>, <span class="st">"spatial"</span>, <span class="st">"temporal"</span><span class="op">)</span>,</span>
<span>  train_prop <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  cutoff_date <span class="op">=</span> <span class="st">"2022-01-01"</span>,</span>
<span>  holdout_locations <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the suitability modeling dataset with columns:</p><ul><li><p><strong>iso_code</strong>: ISO country codes</p></li>
<li><p><strong>date</strong>: Date column (will be converted to Date class)</p></li>
<li><p><strong>cases_binary</strong>: Binary suitability indicator (target variable)</p></li>
<li><p>Additional environmental covariates for modeling</p></li>
</ul></dd>


<dt id="arg-cv-mode">cv_mode<a class="anchor" aria-label="anchor" href="#arg-cv-mode"></a></dt>
<dd><p>Character string specifying the cross-validation approach:</p><ul><li><p><code>"random"</code>: Random train/validation split (default)</p></li>
<li><p><code>"spatial"</code>: Spatial leave-one-out validation (hold out specific countries)</p></li>
<li><p><code>"temporal"</code>: Temporal split (train on historical, test on future data)</p></li>
</ul></dd>


<dt id="arg-train-prop">train_prop<a class="anchor" aria-label="anchor" href="#arg-train-prop"></a></dt>
<dd><p>Numeric proportion (0-1) for training data in random split mode.
Default 0.8 (80% train, 20% validation). Only used when cv_mode = "random".</p></dd>


<dt id="arg-cutoff-date">cutoff_date<a class="anchor" aria-label="anchor" href="#arg-cutoff-date"></a></dt>
<dd><p>Date string (YYYY-MM-DD) for temporal split mode. Training data
includes all observations before this date, validation includes all observations
from this date onward. Default "2022-01-01". Only used when cv_mode = "temporal".</p></dd>


<dt id="arg-holdout-locations">holdout_locations<a class="anchor" aria-label="anchor" href="#arg-holdout-locations"></a></dt>
<dd><p>Character vector of ISO country codes to hold out for
validation in spatial mode. Default NULL uses a predefined set of high-quality
countries. Only used when cv_mode = "spatial".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p><code>train_data</code>: Training dataset</p></li>
<li><p><code>val_data</code>: Validation dataset</p></li>
<li><p><code>split_info</code>: List with split metadata including:</p><ul><li><p><code>cv_mode</code>: Cross-validation mode used</p></li>
<li><p><code>train_n</code>: Number of training observations</p></li>
<li><p><code>val_n</code>: Number of validation observations</p></li>
<li><p><code>train_positive_rate</code>: Proportion of positive cases in training</p></li>
<li><p><code>val_positive_rate</code>: Proportion of positive cases in validation</p></li>
<li><p>Mode-specific metadata (split proportion, cutoff date, or holdout countries)</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Random Split (cv_mode = "random"):</strong></p><ul><li><p>Randomly samples observations for training/validation</p></li>
<li><p>Maintains class balance and temporal distribution</p></li>
<li><p>Good baseline for model development and comparison</p></li>
<li><p>Provides optimistic performance estimates</p></li>
</ul><p><strong>Spatial Split (cv_mode = "spatial"):</strong></p><ul><li><p>Holds out entire countries for validation</p></li>
<li><p>Tests geographic generalization capability</p></li>
<li><p>More realistic for deployment to new regions</p></li>
<li><p>Uses predefined high-quality countries if holdout_locations not specified</p></li>
</ul><p><strong>Temporal Split (cv_mode = "temporal"):</strong></p><ul><li><p>Trains on historical data, validates on future periods</p></li>
<li><p>Tests temporal generalization capability</p></li>
<li><p>Most realistic for operational early warning systems</p></li>
<li><p>Prevents data leakage from future to past</p></li>
<li><p>Maintains LSTM sequence integrity across temporal boundary</p></li>
</ul><p><strong>Recommended CV Strategies:</strong></p><ul><li><p><strong>Development</strong>: Random split for rapid iteration</p></li>
<li><p><strong>Geographic evaluation</strong>: Spatial split with representative countries</p></li>
<li><p><strong>Operational validation</strong>: Temporal split with recent cutoff</p></li>
<li><p><strong>Comprehensive evaluation</strong>: All three modes for robust assessment</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function is designed to work with the MOSAIC cholera environmental suitability
modeling pipeline. Different CV modes provide complementary insights into model
performance and should be used together for comprehensive evaluation.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="est_suitability.html">est_suitability</a></code> for the main LSTM training function that uses these splits.
<code><a href="process_suitability_data.html">process_suitability_data</a></code> for data preprocessing before split generation.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load suitability data</span></span></span>
<span class="r-in"><span><span class="va">data_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHS</span><span class="op">$</span><span class="va">DATA_CHOLERA_WEEKLY</span>,</span></span>
<span class="r-in"><span>                      <span class="st">'cholera_country_weekly_suitability_data.csv'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">data_file</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Random split (default)</span></span></span>
<span class="r-in"><span><span class="va">split_random</span> <span class="op">&lt;-</span> <span class="fu">get_lstm_cv_folds</span><span class="op">(</span><span class="va">data</span>, cv_mode <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Random split with custom proportion</span></span></span>
<span class="r-in"><span><span class="va">split_random_70</span> <span class="op">&lt;-</span> <span class="fu">get_lstm_cv_folds</span><span class="op">(</span><span class="va">data</span>, cv_mode <span class="op">=</span> <span class="st">"random"</span>, train_prop <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spatial split with default high-quality countries</span></span></span>
<span class="r-in"><span><span class="va">split_spatial</span> <span class="op">&lt;-</span> <span class="fu">get_lstm_cv_folds</span><span class="op">(</span><span class="va">data</span>, cv_mode <span class="op">=</span> <span class="st">"spatial"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spatial split with custom countries</span></span></span>
<span class="r-in"><span><span class="va">split_custom</span> <span class="op">&lt;-</span> <span class="fu">get_lstm_cv_folds</span><span class="op">(</span><span class="va">data</span>, cv_mode <span class="op">=</span> <span class="st">"spatial"</span>,</span></span>
<span class="r-in"><span>                                 holdout_locations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGO"</span>, <span class="st">"KEN"</span>, <span class="st">"NGA"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Temporal split with default cutoff (2022-01-01)</span></span></span>
<span class="r-in"><span><span class="va">split_temporal</span> <span class="op">&lt;-</span> <span class="fu">get_lstm_cv_folds</span><span class="op">(</span><span class="va">data</span>, cv_mode <span class="op">=</span> <span class="st">"temporal"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Temporal split with custom cutoff</span></span></span>
<span class="r-in"><span><span class="va">split_temporal_2021</span> <span class="op">&lt;-</span> <span class="fu">get_lstm_cv_folds</span><span class="op">(</span><span class="va">data</span>, cv_mode <span class="op">=</span> <span class="st">"temporal"</span>,</span></span>
<span class="r-in"><span>                                        cutoff_date <span class="op">=</span> <span class="st">"2021-01-01"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access split information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">split_random</span><span class="op">$</span><span class="va">split_info</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use in LSTM training</span></span></span>
<span class="r-in"><span><span class="va">train_sequences</span> <span class="op">&lt;-</span> <span class="fu">create_lstm_sequences</span><span class="op">(</span><span class="va">split_random</span><span class="op">$</span><span class="va">train_data</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">val_sequences</span> <span class="op">&lt;-</span> <span class="fu">create_lstm_sequences</span><span class="op">(</span><span class="va">split_random</span><span class="op">$</span><span class="va">val_data</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gilesjohnr" class="external-link">John R Giles</a>, <a href="https://github.com/ChristopherWLorton" class="external-link">Christopher W Lorton</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

