% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_log_likelihood_distributions.R
\name{calc_log_likelihood_negbin}
\alias{calc_log_likelihood_negbin}
\title{Calculate log-likelihood for Negative Binomial-distributed count data}
\usage{
calc_log_likelihood_negbin(
  observed,
  estimated,
  k = NULL,
  k_min = 3,
  weights = NULL,
  verbose = TRUE
)
}
\arguments{
\item{observed}{Integer vector of observed non-negative counts (e.g., cases, deaths).}

\item{estimated}{Numeric vector of expected values from the model (same length as \code{observed}).}

\item{k}{Numeric scalar; dispersion parameter. If \code{NULL}, it is estimated via method of moments.}

\item{k_min}{Numeric scalar; minimum dispersion floor applied when \code{k} is finite
(either supplied or estimated). Default \code{3}. If \code{k = Inf} (Poisson limit),
no flooring is applied.}

\item{weights}{Optional numeric vector of non-negative weights, same length as \code{observed}.
Default is \code{NULL}, which sets all weights to 1.}

\item{verbose}{Logical; if \code{TRUE}, prints diagnostics including the (floored) dispersion and total log-likelihood.}
}
\value{
A scalar representing the total log-likelihood (numeric).
}
\description{
Computes the total log-likelihood for count data under the Negative Binomial
distribution, using the gamma-function formulation. Each observation can be
weighted.
}
\details{
If \code{k} is not supplied, it is estimated as \eqn{k = \bar x^2 / (s^2 - \bar x)} from
\code{observed}. When this estimate is finite, it is constrained to be at least \code{k_min}.
If \code{s^2 \le \bar x}, the function uses the Poisson limit (\code{k = Inf}).
}
\examples{
# Default k_min = 3
calc_log_likelihood_negbin(c(0, 5, 9), c(3, 4, 5))
# Provide k but allow flooring if too small
calc_log_likelihood_negbin(c(0, 5, 9), c(3, 4, 5), k = 1.2)

}
