% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_model_convergence.R
\name{calc_model_convergence}
\alias{calc_model_convergence}
\title{Calculate model-weight agreement diagnostics from log-likelihoods}
\usage{
calc_model_convergence(
  loglik,
  seeds = NULL,
  delta_max = 6,
  temperature = 1,
  ess_min = 1000,
  A_min = 0.75,
  cvw_max = 1,
  B_min = 2,
  max_w_max = 0.5
)
}
\arguments{
\item{loglik}{Numeric vector of log-likelihoods (one per draw). Higher is better.}

\item{seeds}{Optional vector of seeds corresponding to each likelihood value (same length as \code{loglik}).}

\item{delta_max}{Numeric Δ cutoff used for truncation (default \code{6}).}

\item{temperature}{Positive scalar temperature for weight scaling (default \code{1}).
See \code{\link[=calc_model_akaike_weights]{calc_model_akaike_weights()}} for guidance.}

\item{ess_min}{Numeric target minimum effective sample size (ESS; default \code{1000}).}

\item{A_min}{Numeric target minimum agreement index (default \code{0.75}).}

\item{cvw_max}{Numeric target maximum coefficient of variation of weights (default \code{1.0}).}

\item{B_min}{Integer target minimum retained set size \eqn{B} (default \code{2}).}

\item{max_w_max}{Numeric in (0, 1] for the maximum allowed normalized weight (default \code{0.5}).}
}
\value{
A list with:
\itemize{
\item \code{loglik}   — original log-likelihood vector.
\item \code{delta}    — vector of \eqn{\Delta_i}.
\item \code{delta_max} — the Δ cutoff used.
\item \code{temperature} — the temperature used.
\item \code{weights}  — list from \code{\link[=calc_model_akaike_weights]{calc_model_akaike_weights()}} with \code{w}, \code{w_tilde}, \code{retained}, \code{B_idx}.
\item \code{retained} — logical vector indicating retained draws (same as \code{weights$retained}).
\item \code{H}        — entropy value from agreement index calculation.
\item \code{metrics}  — named numeric vector: \code{ESS}, \code{A}, \code{CVw}, \code{B_size}, \code{max_w}.
\item \code{targets}  — named numeric vector of thresholds.
\item \code{pass}     — named logical vector indicating if each metric meets target.
\item \code{status}   — named character vector: "pass", "warn", or "fail" for each metric.
}
}
\description{
Convenience wrapper that computes ΔAIC, truncated/temperature-scaled Akaike weights,
ESS, agreement index \eqn{A}, coefficient of variation of weights (CVw),
retained set size \eqn{B}, and the maximum normalized weight
\eqn{\max_i \tilde w_i}. Results are compared to recommended thresholds.
}
\section{Important Note}{

This function measures \strong{model-weight agreement} and \strong{evidence concentration},
not MCMC convergence. For MCMC diagnostics, use R-hat, effective sample size from chains,
trace plots, etc. The "convergence" terminology here refers to agreement across the
ensemble of parameter draws, not chain convergence.
}

\section{Assumptions}{

The ΔAIC computation assumes all draws have the same number of parameters k.
For models with different k, compute AIC = -2\emph{loglik + 2}k first, then use Δ = AIC - min(AIC).
}

\section{Recommended usage}{

\itemize{
\item If the top model dominates (\code{max_w \u2192 1}), try \code{temperature = 1.5–2}
        and/or a looser \code{delta_max} (e.g., 20–100) to increase ESS while preserving ranking.
\item Keep \code{temperature \u2264 3} for most workflows to avoid overly flat weights.
}
}

\examples{
set.seed(42)
ll <- 1500 + rnorm(3000, sd = 3)
# Mild flattening for smoother posterior plots
res <- calc_model_convergence(ll, delta_max = 20, temperature = 1.8)
res$metrics; res$pass

}
\seealso{
\code{\link[=calc_model_aic_delta]{calc_model_aic_delta()}},
\code{\link[=calc_model_akaike_weights]{calc_model_akaike_weights()}},
\code{\link[=calc_model_ess]{calc_model_ess()}},
\code{\link[=calc_model_agreement_index]{calc_model_agreement_index()}},
\code{\link[=calc_model_cvw]{calc_model_cvw()}},
\code{\link[=calc_model_max_weight]{calc_model_max_weight()}}

Other calibration-metrics: 
\code{\link{calc_model_agreement_index}()},
\code{\link{calc_model_aic_delta}()},
\code{\link{calc_model_akaike_weights}()},
\code{\link{calc_model_cvw}()},
\code{\link{calc_model_ess}()},
\code{\link{calc_model_max_weight}()},
\code{\link{plot_model_convergence}()}
}
\concept{calibration-metrics}
