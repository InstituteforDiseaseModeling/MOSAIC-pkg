% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_model_mse.R
\name{calc_model_mse}
\alias{calc_model_mse}
\title{Mean Squared Error Between Observed and Estimated Series}
\usage{
calc_model_mse(
  observed,
  estimated,
  na_rm = TRUE,
  finite_only = TRUE,
  weights = NULL,
  verbose = FALSE
)
}
\arguments{
\item{observed}{A numeric vector or matrix of observed values.}

\item{estimated}{A numeric vector or matrix of model-estimated values
of the same length (after flattening) as \code{observed}.}

\item{na_rm}{Logical; if \code{TRUE} (default), remove any pair with
\code{NA}. If \code{FALSE} and any \code{NA}/\code{Inf} are found (or lengths
mismatch), returns \code{NA_real_}.}

\item{finite_only}{Logical; if \code{TRUE} (default), also drop non-finite
values (\code{Inf}, \code{-Inf}, \code{NaN}) during pairwise filtering.}

\item{weights}{Optional numeric vector of non-negative weights (recycled if
length 1). Must align with the number of \strong{valid pairs} after filtering.
If \code{NULL} (default), all pairs receive equal weight.}

\item{verbose}{Logical; if \code{TRUE}, emit brief diagnostic messages.}
}
\value{
A single numeric value: the mean squared error. Returns \code{NA_real_}
if fewer than one valid pair remains or if total weight is zero.
}
\description{
Computes the \strong{mean squared error (MSE)} between an observed series and a
model-estimated series. Inputs may be numeric vectors or matrices (e.g.,
\eqn{L \times T} location-by-time arrays); values are flattened and compared
\strong{pairwise} with optional weights.
}
\details{
Let \eqn{\{(y_i, \hat{y}_i)\}_{i=1}^{n}} be the set of \strong{valid pairs} after
removing any entries with \code{NA}/\code{Inf} (when \code{na_rm = TRUE} and
\code{finite_only = TRUE}). The weighted MSE is
\deqn{
\mathrm{MSE}_w \;=\; \frac{\sum_{i=1}^{n} w_i \, ( \hat{y}_i - y_i )^2}{\sum_{i=1}^{n} w_i},
}
which reduces to the standard unweighted MSE when \eqn{w_i \equiv 1}.
}
\section{Input shapes}{

Vectors and matrices are supported. Matrices are flattened (column-major)
in both \code{observed} and \code{estimated} before pairwise comparison.
}

\examples{
# Vector example
set.seed(1)
y  <- rpois(20, 10)
yh <- y + rnorm(20, 0, 2)
calc_model_mse(y, yh)

# Matrix example (locations x time)
Y  <- matrix(rpois(30, 5), nrow = 3)
Yh <- Y + matrix(rnorm(30, 0, 1), nrow = 3)
calc_model_mse(Y, Yh)

# With weights (e.g., emphasize recent time points)
w <- rep(seq(0.5, 1.5, length.out = ncol(Y)), each = nrow(Y))
calc_model_mse(Y, Yh, weights = w)

}
\seealso{
\code{\link[=calc_model_cor]{calc_model_cor()}}, \code{\link[=calc_model_likelihood]{calc_model_likelihood()}}, \code{\link[=calc_model_ppc]{calc_model_ppc()}}
}
