% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_model_ppc.R
\name{calc_model_ppc}
\alias{calc_model_ppc}
\title{Calculate Posterior Predictive Checks for Best Model}
\usage{
calc_model_ppc(
  results,
  schema = NULL,
  n_replications = 100,
  method = c("statistical", "simulation"),
  config_base,
  PATHS,
  overdispersion = NULL,
  parallel = TRUE,
  n_cores = 4,
  verbose = TRUE
)
}
\arguments{
\item{results}{Data frame or matrix containing calibration results with columns
for likelihood and parameters}

\item{schema}{Optional calibration_results_schema object from create_results_schema().
If NULL, will attempt to detect structure from results.}

\item{n_replications}{Integer. Number of predictive samples to generate (default 100)}

\item{method}{Character. Method for generating samples: "simulation" (re-run model)
or "statistical" (resample from distributions)}

\item{config_base}{Base configuration list containing model settings and observed data}

\item{PATHS}{List of file paths from get_paths()}

\item{overdispersion}{Numeric. Overdispersion parameter for statistical resampling.
If NULL, will estimate from residuals (default NULL)}

\item{parallel}{Logical. Use parallel processing for simulation method (default TRUE)}

\item{n_cores}{Integer. Number of cores for parallel execution (default 4)}

\item{verbose}{Logical. Print progress messages (default TRUE)}
}
\value{
A list of class "mosaic_ppc" containing:
\itemize{
\item \code{observed}: List with observed \code{cases} and \code{deaths} matrices
\item \code{predicted}: Array of predictions \link{n_reps, n_locations, n_time} for cases and deaths
\item \code{best_model}: Information about the best model (index, likelihood, parameters)
\item \code{method}: Method used for generating samples
\item \code{diagnostics}: Runtime and diagnostic information
}
}
\description{
Generates posterior predictive samples from the single best-fitting model
(highest log-likelihood) to assess model adequacy. Supports both simulation-based
(re-running model) and statistical resampling approaches.
}
\details{
This function implements posterior predictive checking for the single best model:

\strong{Simulation Method}: Re-runs the best model multiple times with different random
seeds to capture stochastic variability. More accurate but computationally intensive.

\strong{Statistical Method}: Samples from negative binomial distributions centered on
the best model's predictions. Much faster but requires appropriate overdispersion
parameter.

The function automatically identifies the best model based on maximum likelihood
and generates replicate samples to assess model fit quality.
}
\examples{
\dontrun{
# Using schema (recommended)
schema <- create_results_schema(config_base)
ppc <- calc_model_ppc(
  results = calibration_results,
  schema = schema,
  n_replications = 100,
  method = "statistical",
  config_base = config_base,
  PATHS = PATHS
)

# Without schema (auto-detect)
ppc <- calc_model_ppc(
  results = calibration_results,
  n_replications = 50,
  method = "simulation",
  config_base = config_base,
  PATHS = PATHS
)
}

}
\seealso{
\code{\link[=plot_model_ppc]{plot_model_ppc()}}, \code{\link[=calc_ppc_diagnostics]{calc_ppc_diagnostics()}}
}
