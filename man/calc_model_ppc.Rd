% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_model_ppc.R
\name{calc_model_ppc}
\alias{calc_model_ppc}
\title{Calculate Best Model Predictive Check Samples}
\usage{
calc_model_ppc(
  results,
  col_ll,
  col_params,
  col_seed,
  param_names = NULL,
  posterior_weights = NULL,
  n_posterior_samples = 100,
  n_replications = 50,
  config_base,
  priors_base,
  PATHS,
  parallel = TRUE,
  n_cores = 4,
  verbose = TRUE
)
}
\arguments{
\item{results}{Data frame containing calibration results with parameter columns,
likelihood values, and importance weights from posterior analysis.}

\item{col_ll}{Integer. Column index for log-likelihood values.}

\item{col_params}{Integer vector. Column indices for model parameters.}

\item{col_seed}{Integer. Column index for random seeds (for reproducibility).}

\item{param_names}{Optional character vector of parameter names corresponding to col_params.
If NULL, will use column names from results or generate generic names.}

\item{posterior_weights}{Numeric vector of posterior importance weights.
Currently unused but kept for backward compatibility.}

\item{n_posterior_samples}{Integer. DEPRECATED: Ignored (only the single best model is used).}

\item{n_replications}{Integer. Number of replications of the best model
to capture stochastic variability (default 50).}

\item{config_base}{Base LASER configuration list (from get_location_config).}

\item{priors_base}{Prior distributions list (from get_location_priors).}

\item{PATHS}{List of file paths (from get_paths).}

\item{parallel}{Logical. Whether to run simulations in parallel (default TRUE).}

\item{n_cores}{Integer. Number of cores for parallel execution (default 4).}

\item{verbose}{Logical. Whether to print progress messages (default TRUE).}
}
\value{
A list containing:
\itemize{
\item \code{observed}: List with \code{cases} and \code{deaths} matrices
\item \code{predictions}: List of predicted \code{cases}/\code{deaths} for each replication
\item \code{summary_stats}: Aggregated prediction statistics (mean, median, 2.5\\%/97.5\\% quantiles, sd)
\item \code{best_model}: Information about the best model used (index, sim_id, seed, likelihood, parameters)
\item \code{diagnostics}: Runtime and replication information
}
}
\description{
Generates predictive samples by identifying the single best-fitting model
(highest log-likelihood) and re-running it multiple times with different
random seeds to capture stochastic variability. This enables model validation
through comparison of observed data with predictions from the best model.
}
\details{
This function implements best model predictive checking:
\enumerate{
\item Identifies the single model with highest log-likelihood
\item Re-runs that model multiple times with different random seeds
\item Captures stochastic variability of the best-fitting model
\item Returns structured results for visualization and diagnostic checking
}

The predictive distribution represents what the best model predicts
we should observe, accounting for stochastic noise. Systematic discrepancies
between observed and predicted data indicate model misspecification.
}
\examples{
\dontrun{
ppc_results <- calc_model_ppc(
  results = calibration_results,
  col_ll = which(names(calibration_results) == "likelihood"),
  col_params = param_cols,
  col_seed = which(names(calibration_results) == "seed"),
  param_names = names(calibration_results)[param_cols],
  n_replications = 50,
  config_base = config_base,
  priors_base = priors_base,
  PATHS = PATHS
)
}

}
\seealso{
\code{\link[=plot_model_ppc]{plot_model_ppc()}}, \code{\link[=calc_model_posterior_distributions]{calc_model_posterior_distributions()}}

Other model-validation: 
\code{\link{plot_model_ppc}()}
}
\concept{model-validation}
