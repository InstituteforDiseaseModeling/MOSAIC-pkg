% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/npe_funcs.R
\name{calc_npe_posterior_predictive_checks}
\alias{calc_npe_posterior_predictive_checks}
\title{Posterior Predictive Checks (PPC) for NPE Models}
\usage{
calc_npe_posterior_predictive_checks(
  npe_model_dir,
  observed_data_file,
  n_posterior_samples = 1000,
  n_predictive_samples = 1,
  test_statistics = c("mean", "var", "max", "skewness"),
  output_dir = NULL,
  verbose = TRUE,
  seed = 42
)
}
\arguments{
\item{npe_model_dir}{Directory containing trained NPE model files}

\item{observed_data_file}{Path to observed data file (parquet format)}

\item{n_posterior_samples}{Number of posterior samples to draw (default: 1000)}

\item{n_predictive_samples}{Number of predictive samples per posterior sample (default: 1)}

\item{test_statistics}{Vector of test statistics to compute (default: c("mean", "var", "max", "skewness"))}

\item{output_dir}{Directory to save PPC results and plots (default: same as npe_model_dir)}

\item{verbose}{Logical; print progress messages (default: TRUE)}

\item{seed}{Random seed for reproducibility (default: 42)}
}
\value{
List containing:
\describe{
\item{ppc_results}{Data frame with test statistics for observed and predicted data}
\item{p_values}{P-values for each test statistic}
\item{ppc_plots}{List of ggplot2 objects showing predictive distributions}
\item{overall_fit}{Overall model fit assessment}
}
}
\description{
Performs posterior predictive checks to validate NPE models by comparing
observed data with predictions from the posterior predictive distribution.
This helps identify model misspecification and assess goodness of fit.
}
\details{
Posterior predictive checks work by:
\enumerate{
\item Using observed data to get posterior samples θ₁,...,θₙ ~ p(θ|y_obs)
\item For each θᵢ, simulating replicated data y_rep,i ~ p(y|θᵢ)
\item Computing test statistics T(y_rep) and T(y_obs)
\item Checking if T(y_obs) is typical of the predictive distribution
}

Good model fit should show T(y_obs) within the central range of T(y_rep).
Extreme values indicate potential model misspecification.
}
\examples{
\dontrun{
# Run posterior predictive checks
ppc_results <- calc_npe_posterior_predictive_checks(
  npe_model_dir = "./results/npe",
  observed_data_file = "./data/observed_cases.parquet",
  n_posterior_samples = 500,
  test_statistics = c("mean", "var", "max")
)

# Check model fit
print(ppc_results$overall_fit)

# Display PPC plots
print(ppc_results$ppc_plots$mean)
}

}
