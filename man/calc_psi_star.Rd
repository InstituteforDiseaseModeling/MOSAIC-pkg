% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_psi_star.R
\name{calc_psi_star}
\alias{calc_psi_star}
\title{Calibrate Daily Suitability on the Logit Scale
(vector; optional causal EWMA + time offset + NA filling)}
\usage{
calc_psi_star(
  psi,
  a = 1,
  b = 0,
  z = 1,
  k = 0,
  eps = 1e-06,
  fill_method = c("locf", "linear")
)
}
\arguments{
\item{psi}{Numeric vector in \eqn{[0,1]} (daily suitability \eqn{\psi_t}).}

\item{a}{Numeric (>0). Shape/gain on the logit scale (\eqn{a>1} sharpens; \eqn{a<1} flattens).}

\item{b}{Numeric. Scale/offset on the logit scale (baseline up/down).}

\item{z}{Numeric in \eqn{(0,1]} controlling causal EWMA smoothing; \code{1} = no smoothing.}

\item{k}{Numeric or integer; time offset in \strong{days}. Positive = forward/right; negative = backward/left.
Non-integers are rounded to nearest integer.}

\item{eps}{Small positive number to clip \code{psi} away from \{0,1\} before \code{qlogis}.}

\item{fill_method}{Character; one of \code{c("locf","linear")} controlling how NA gaps are filled.}
}
\value{
Numeric vector \eqn{\tilde\psi^{\star}_t} (same length as \code{psi}):
calibrated, offset, NA-filled, and smoothed if \code{z<1}.
}
\description{
Transforms a \strong{daily} suitability series \eqn{\psi_t \in [0,1]} with a
\strong{logit-scale affine calibration}, optional \strong{causal EWMA smoothing}, and an
optional \strong{time offset} \eqn{k}. Any missing values introduced by the shift
(or pre-existing) are filled using either \strong{LOCF} (default) or \strong{linear interpolation}.
}
\details{
\strong{Offset (index shift, in days):} \eqn{\psi^{(k)}_t = \psi_{t-k}}.
Positive \eqn{k} shifts the series forward/right (delay); negative \eqn{k} shifts backward/left.
Non-integer \eqn{k} is rounded to the nearest integer.

\strong{Calibration (odds-space power & scale):}
\deqn{\psi_t^{\star}=\sigma\!\big(a\cdot \mathrm{logit}(\tilde\psi_t)+b\big),\quad
\tilde\psi_t=\min\{\max(\psi^{(k)}_t,\varepsilon),\,1-\varepsilon\}}
with \eqn{\text{odds}^\star_t = e^{b}\,(\text{odds}_t)^{a}}, \;
\eqn{\text{odds}_t=\tilde\psi_t/(1-\tilde\psi_t)}.

\strong{Optional causal smoothing (no look-ahead):}
\deqn{\tilde\psi^{\star}_t = z\,\psi^{\star}_t + (1-z)\,\tilde\psi^{\star}_{t-1},\quad
z\in(0,1],\ \tilde\psi^{\star}_1=\psi^{\star}_1.}

\strong{NA filling (after calibration, before smoothing):}
Choose via \code{fill_method}:
\itemize{
\item \code{"locf"} — forward fill (LOCF) then backward pass for leading gaps.
\item \code{"linear"} — linear interpolation for interior gaps with constant edge extension.
}
If all values are NA after shifting, the function falls back to a constant baseline \eqn{\sigma(b)}.
}
\seealso{
\code{\link[stats]{qlogis}}, \code{\link[stats]{plogis}}, \code{\link[stats]{approx}}
}
