% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_spatial_correlation.R
\name{calc_spatial_correlation}
\alias{calc_spatial_correlation}
\title{Calculate spatial correlation between two locations}
\usage{
calc_spatial_correlation(I_i, I_j, N_i = 1, N_j = 1)
}
\arguments{
\item{I_i}{Numeric vector. Total infections in location \emph{i} at each
reporting time.}

\item{I_j}{Numeric vector. Total infections in location \emph{j} at each
reporting time. Must be the same length as \code{I_i}.}

\item{N_i}{Numeric \strong{scalar or vector}. Population size(s) of location \emph{i}.
\itemize{
\item If a scalar, the value is recycled across all time points.
\item If a vector, it must be the same length as the infection series and
supplies time-varying population sizes.
\item Default is \code{1}, implying that infection counts are already expressed
as prevalences.
}}

\item{N_j}{Numeric \strong{scalar or vector}. Population size(s) of location \emph{j}.
Recycling and length rules mirror those of \code{N_i}. Default \code{1}.}
}
\value{
Numeric scalar in the interval [-1, 1] giving the spatial
correlation between the two locations, or \code{NA_real_} if the calculation is
not possible (e.g. all values \code{NA}, zero variance).
}
\description{
Computes the Pearson spatial–correlation coefficient
\eqn{\mathcal{C}_{ij}} (Keeling & Rohani 2002) for a pair of locations
\emph{i} and \emph{j} from \strong{single} infection time-series per location.
}
\details{
The prevalence series are
\eqn{y_{it} = I_{it} / N_{i,t}} and
\eqn{y_{jt} = I_{jt} / N_{j,t}}, where the population sizes
\eqn{N_{i,t}} and \eqn{N_{j,t}} may be either \strong{scalars} (constant over
time) or \strong{vectors} the same length as the infection series
(time-varying).

Rows containing \code{NA} in either prevalence series are removed
automatically. If fewer than two paired observations remain, the function
returns \code{NA_real_}.
A consistency check stops execution if any computed prevalence exceeds 1.
}
\examples{
set.seed(1)
t  <- 20
I_i <- rpois(t,  8)
I_j <- rpois(t, 12)
N_i <- round(seq(9.8e4, 1.02e5, len = t))   # growing population
N_j <- 8e4                                   # constant population
calc_spatial_correlation(I_i, I_j, N_i, N_j)

}
\references{
Keeling M.J., Rohani P. (2002) \emph{Ecology Letters} \strong{5}, 20–29.
}
