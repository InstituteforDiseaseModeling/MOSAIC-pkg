% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/est_CFR_hierarchical.R
\name{est_CFR_hierarchical}
\alias{est_CFR_hierarchical}
\title{Estimate Case Fatality Rate using Hierarchical GAM with Time Series Splines}
\usage{
est_CFR_hierarchical(
  PATHS,
  min_cases = 20,
  k_year = 12,
  include_country_trends = TRUE,
  population_weighted = FALSE,
  save_diagnostics = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{PATHS}{List containing paths to data directories, typically from get_paths()}

\item{min_cases}{Integer, minimum number of cases required to include observation (default 20)}

\item{k_year}{Integer, number of basis functions for year spline (default 12)}

\item{include_country_trends}{Logical, whether to include country-specific temporal trends (default TRUE)}

\item{population_weighted}{Logical, whether to weight observations by population size from UN data (default FALSE)}

\item{save_diagnostics}{Logical, whether to save diagnostic plots (default TRUE)}

\item{verbose}{Logical, whether to print progress messages (default TRUE)}
}
\value{
List containing:
\itemize{
\item model: Fitted GAM model object
\item predictions: Data frame with CFR estimates for all countries and years
\item country_effects: Estimated country-specific deviations
\item temporal_trend: Population-average temporal trend
\item validation: Cross-validation results for recent years
\item summary: Summary statistics and model fit metrics
}
}
\description{
Fits a hierarchical generalized additive model (GAM) to estimate case fatality rates (CFR)
across African countries and time periods. The model uses smooth splines for temporal trends
with country-specific random effects, handling missingness by borrowing strength across
countries and years. Results are saved to MODEL_INPUT directory for use in MOSAIC simulations.
}
\details{
The function fits a hierarchical GAM model with the following structure:
\itemize{
\item Global temporal trend using thin-plate splines
\item Country-specific random intercepts
\item Optional country-specific smooth deviations from global trend
\item Binomial likelihood with logit link for proper handling of rates
\item Predictions extended to current year based on Sys.Date()
}

Model outputs include:
\itemize{
\item Point estimates and 95\% confidence intervals for all country-years
\item Country-specific random effects quantifying systematic differences
\item Smooth temporal trends showing CFR evolution over time
\item Model diagnostics and validation metrics
}
}
\examples{
\dontrun{
# Standard usage
PATHS <- get_paths()
cfr_model <- est_CFR_hierarchical(PATHS)

# Custom settings for smoother trends
cfr_model <- est_CFR_hierarchical(
  PATHS,
  min_cases = 50,
  k_year = 8,
  include_country_trends = FALSE
)
}

}
