% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/est_initial_S.R
\name{est_initial_S}
\alias{est_initial_S}
\title{Estimate Initial S Compartment from Other Compartment Priors}
\usage{
est_initial_S(
  PATHS,
  priors,
  config,
  n_samples = 1000,
  t0 = NULL,
  variance_inflation = 0,
  verbose = TRUE,
  min_S_proportion = 0.01
)
}
\arguments{
\item{PATHS}{List containing paths to data directories (for compatibility)}

\item{priors}{Prior distributions object containing estimated priors for V1, V2, E, I, R}

\item{config}{Configuration object containing location codes}

\item{n_samples}{Integer, number of Monte Carlo samples for uncertainty quantification (default 1000)}

\item{t0}{Date object, target date for estimation (default NULL, used for metadata)}

\item{variance_inflation}{Numeric factor to inflate variance of fitted Beta distributions (default 1 = no inflation).
Values > 1 increase uncertainty while preserving the mean. For example, 2 doubles the variance.}

\item{verbose}{Logical, whether to print progress messages (default TRUE)}

\item{min_S_proportion}{Numeric, minimum allowed S proportion to prevent negative values (default 0.01 = 1\%)}
}
\value{
List with priors_default-compatible structure containing:
\describe{
\item{metadata}{Information about the estimation run including summary statistics}
\item{parameters_location}{Parameter hierarchy matching priors_default:
\itemize{
\item prop_S_initial: Beta distribution parameters for S/N by location
}
Each parameter contains $parameters$location$ISO_CODE with shape1 and shape2
}
}
}
\description{
Estimates the initial proportion of the population in the Susceptible (S) compartment
using the constraint S + V1 + V2 + E + I + R = 1. This function samples from the
estimated priors of other compartments and calculates S as the constrained residual,
ensuring mathematical consistency while propagating uncertainty from all compartments.
}
\details{
The function implements a constrained residual approach:

\strong{Method Overview:}
\enumerate{
\item Sample from estimated Beta priors for V1, V2, E, I, R compartments
\item Calculate S as constrained residual: S = 1 - (V1 + V2 + E + I + R)
\item Apply constraints: ensure S ≥ min_S_proportion and handle over-allocation
\item Fit Beta distribution to S samples using CI expansion method
\item Return priors-compatible structure with metadata
}

\strong{Constraint Handling:}
\itemize{
\item If other compartments sum > (1 - min_S_proportion), proportionally scale them down
\item Ensures S is always ≥ min_S_proportion for biological realism
\item Maintains mathematical consistency: all compartments sum to 1
}

\strong{Fallback Behavior:}
\itemize{
\item If estimated priors unavailable for any compartment, uses default prior parameters
\item Locations without any estimated compartments use independent S prior (Beta(30, 7.5))
\item Graceful degradation ensures function always returns valid results
}

\strong{Uncertainty Propagation:}
\itemize{
\item S uncertainty incorporates uncertainty from all other compartments
\item Variance inflation applied using CI expansion method consistent with other est_initial_* functions
\item Countries with high vaccination/immunity naturally get lower and more certain S estimates
}
}
\examples{
\dontrun{
# After running est_initial_V1_V2, est_initial_E_I, est_initial_R
PATHS <- get_paths()
priors_updated <- priors_default  # With updated V1,V2,E,I,R compartments

initial_S <- est_initial_S(
  PATHS = PATHS,
  priors = priors_updated,
  config = config_default,
  n_samples = 1000,
  variance_inflation = 2  # Double the variance for less constrained priors
)

# Access results for a location
eth_s_params <- initial_S$parameters_location$prop_S_initial$parameters$location$ETH
eth_s_mean <- eth_s_params$metadata$mean
}

}
\seealso{
\code{\link{est_initial_V1_V2}} for vaccination compartment estimation
\code{\link{est_initial_E_I}} for infection compartment estimation
\code{\link{est_initial_R}} for recovered compartment estimation
\code{\link{fit_beta_from_ci}} for Beta distribution fitting with CI constraints
}
