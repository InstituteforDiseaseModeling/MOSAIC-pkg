% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/npe_posterior.R
\name{estimate_npe_posterior}
\alias{estimate_npe_posterior}
\title{Estimate NPE Posterior}
\usage{
estimate_npe_posterior(
  model,
  observed_data,
  n_samples = 10000,
  return_log_probs = TRUE,
  quantiles = c(0.025, 0.25, 0.5, 0.75, 0.975),
  output_dir = NULL,
  verbose = TRUE,
  rejection_sampling = FALSE,
  max_rejection_rate = 0.2,
  max_attempts = 10
)
}
\arguments{
\item{model}{Trained NPE model object}

\item{observed_data}{Data frame with observed outbreak data}

\item{n_samples}{Number of posterior samples to generate}

\item{return_log_probs}{If TRUE, return log q(theta|x) for SMC (default TRUE)}

\item{quantiles}{Quantile levels to compute}

\item{output_dir}{Directory to save results (NULL = don't save)}

\item{verbose}{Print progress messages}

\item{rejection_sampling}{Logical. If TRUE, perform rejection sampling to ensure
all returned samples are within parameter bounds (default FALSE).}

\item{max_rejection_rate}{Numeric. Maximum acceptable rejection rate (0-1).
If exceeded after 3 attempts, sampling stops early (default 0.20).}

\item{max_attempts}{Integer. Maximum number of sampling attempts before giving up
(default 10).}
}
\value{
List containing:
\itemize{
\item samples - Matrix of posterior samples (n_samples x n_params)
\item log_probs - Vector of log q(theta|x) values for SMC
\item quantiles - Data frame of parameter quantiles
\item param_names - Names of parameters
\item n_samples - Actual number of samples returned
\item rejection_info - List with rejection sampling diagnostics (NULL if disabled):
\itemize{
\item enabled - TRUE
\item requested - Target number of samples
\item achieved - Actual samples obtained
\item total_drawn - Total samples generated (including rejected)
\item rejection_rate - Proportion of samples rejected
\item n_attempts - Number of sampling iterations
}
}
}
\description{
Generates posterior samples using a trained NPE model and CRITICALLY
extracts log q(theta|x) values needed for SMC importance weights.
}
