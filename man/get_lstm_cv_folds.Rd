% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_lstm_cv_folds.R
\name{get_lstm_cv_folds}
\alias{get_lstm_cv_folds}
\title{Generate Cross-Validation Split for LSTM Environmental Suitability Models}
\usage{
get_lstm_cv_folds(
  data,
  cv_mode = c("random", "spatial", "temporal"),
  train_prop = 0.8,
  cutoff_date = "2022-01-01",
  holdout_locations = NULL
)
}
\arguments{
\item{data}{A data frame containing the suitability modeling dataset with columns:
\itemize{
\item \strong{iso_code}: ISO country codes
\item \strong{date}: Date column (will be converted to Date class)
\item \strong{cases_binary}: Binary suitability indicator (target variable)
\item Additional environmental covariates for modeling
}}

\item{cv_mode}{Character string specifying the cross-validation approach:
\itemize{
\item \code{"random"}: Random train/validation split (default)
\item \code{"spatial"}: Spatial leave-one-out validation (hold out specific countries)
\item \code{"temporal"}: Temporal split (train on historical, test on future data)
}}

\item{train_prop}{Numeric proportion (0-1) for training data in random split mode.
Default 0.8 (80\% train, 20\% validation). Only used when cv_mode = "random".}

\item{cutoff_date}{Date string (YYYY-MM-DD) for temporal split mode. Training data
includes all observations before this date, validation includes all observations
from this date onward. Default "2022-01-01". Only used when cv_mode = "temporal".}

\item{holdout_locations}{Character vector of ISO country codes to hold out for
validation in spatial mode. Default NULL uses a predefined set of high-quality
countries. Only used when cv_mode = "spatial".}
}
\value{
A list containing:
\itemize{
\item \code{train_data}: Training dataset
\item \code{val_data}: Validation dataset
\item \code{split_info}: List with split metadata including:
\itemize{
\item \code{cv_mode}: Cross-validation mode used
\item \code{train_n}: Number of training observations
\item \code{val_n}: Number of validation observations
\item \code{train_positive_rate}: Proportion of positive cases in training
\item \code{val_positive_rate}: Proportion of positive cases in validation
\item Mode-specific metadata (split proportion, cutoff date, or holdout countries)
}
}
}
\description{
This function creates train/validation splits for LSTM training using three different
cross-validation strategies: random sampling, spatial leave-one-out, or temporal cutoff.
Each approach provides different insights into model generalization capability for
cholera environmental suitability prediction.
}
\details{
\strong{Random Split (cv_mode = "random"):}
\itemize{
\item Randomly samples observations for training/validation
\item Maintains class balance and temporal distribution
\item Good baseline for model development and comparison
\item Provides optimistic performance estimates
}

\strong{Spatial Split (cv_mode = "spatial"):}
\itemize{
\item Holds out entire countries for validation
\item Tests geographic generalization capability
\item More realistic for deployment to new regions
\item Uses predefined high-quality countries if holdout_locations not specified
}

\strong{Temporal Split (cv_mode = "temporal"):}
\itemize{
\item Trains on historical data, validates on future periods
\item Tests temporal generalization capability
\item Most realistic for operational early warning systems
\item Prevents data leakage from future to past
\item Maintains LSTM sequence integrity across temporal boundary
}

\strong{Recommended CV Strategies:}
\itemize{
\item \strong{Development}: Random split for rapid iteration
\item \strong{Geographic evaluation}: Spatial split with representative countries
\item \strong{Operational validation}: Temporal split with recent cutoff
\item \strong{Comprehensive evaluation}: All three modes for robust assessment
}
}
\note{
This function is designed to work with the MOSAIC cholera environmental suitability
modeling pipeline. Different CV modes provide complementary insights into model
performance and should be used together for comprehensive evaluation.
}
\examples{
\dontrun{
# Load suitability data
data_file <- file.path(PATHS$DATA_CHOLERA_WEEKLY,
                      'cholera_country_weekly_suitability_data.csv')
data <- read.csv(data_file, stringsAsFactors = FALSE)

# Random split (default)
split_random <- get_lstm_cv_folds(data, cv_mode = "random")

# Random split with custom proportion
split_random_70 <- get_lstm_cv_folds(data, cv_mode = "random", train_prop = 0.7)

# Spatial split with default high-quality countries
split_spatial <- get_lstm_cv_folds(data, cv_mode = "spatial")

# Spatial split with custom countries
split_custom <- get_lstm_cv_folds(data, cv_mode = "spatial",
                                 holdout_locations = c("AGO", "KEN", "NGA"))

# Temporal split with default cutoff (2022-01-01)
split_temporal <- get_lstm_cv_folds(data, cv_mode = "temporal")

# Temporal split with custom cutoff
split_temporal_2021 <- get_lstm_cv_folds(data, cv_mode = "temporal",
                                        cutoff_date = "2021-01-01")

# Access split information
print(split_random$split_info)

# Use in LSTM training
train_sequences <- create_lstm_sequences(split_random$train_data, ...)
val_sequences <- create_lstm_sequences(split_random$val_data, ...)
}

}
\seealso{
\code{\link{est_suitability}} for the main LSTM training function that uses these splits.
\code{\link{process_suitability_data}} for data preprocessing before split generation.
}
