% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_model_likelihood.R
\name{get_model_likelihood}
\alias{get_model_likelihood}
\title{Compute the total model likelihood over multiple locations and time steps,
auto-selecting Poisson or NegBin for each location/outcome}
\usage{
get_model_likelihood(
  obs_cases,
  est_cases,
  obs_deaths,
  est_deaths,
  weight_cases = NULL,
  weight_deaths = NULL,
  weights_location = NULL,
  weights_time = NULL,
  verbose = FALSE
)
}
\arguments{
\item{obs_cases}{Matrix of observed cases, \code{n_locations} x \code{n_time_steps}.}

\item{est_cases}{Matrix of estimated cases, same dimension as \code{obs_cases}.}

\item{obs_deaths}{Matrix of observed deaths, \code{n_locations} x \code{n_time_steps}.}

\item{est_deaths}{Matrix of estimated deaths, same dimension as \code{obs_deaths}.}

\item{weight_cases}{Numeric scalar (or \code{NULL}), default \code{NULL} which sets to 1 internally.}

\item{weight_deaths}{Numeric scalar (or \code{NULL}), default \code{NULL} which sets to 1 internally.}

\item{weights_location}{Optional numeric vector of length \code{n_locations}, or \code{NULL}.
If \code{NULL}, all locations are weighted equally.}

\item{weights_time}{Optional numeric vector of length \code{n_time_steps}, or \code{NULL}.
If \code{NULL}, all time steps are weighted equally.}

\item{verbose}{Logical; if \code{TRUE}, prints summary messages. Default is \code{FALSE}.}
}
\value{
A single numeric value giving the total log-likelihood across all locations
and time steps, or \code{NA_real_} if all locations are skipped.
}
\description{
This function expects matrices of observed and estimated cases and deaths (size
\code{n_locations} x \code{n_time_steps}), plus optional weight vectors for
locations and time steps (\code{weights_location} and \code{weights_time}).
It automatically selects Poisson or Negative Binomial for each location and outcome
based on whether \code{Var(observed) / Mean(observed) >= 1.5}. If the ratio is below
1.5, it uses Poisson; otherwise it uses NegBin. Then it multiplies
the cases log-likelihood by \code{weight_cases} and the deaths log-likelihood by
\code{weight_deaths} for additional flexibility in balancing the two outcomes.
}
