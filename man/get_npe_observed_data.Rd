% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_npe_observed_data.R
\name{get_npe_observed_data}
\alias{get_npe_observed_data}
\title{Get NPE Observed Data from Configuration}
\usage{
get_npe_observed_data(
  config,
  location_codes = NULL,
  include_deaths = FALSE,
  time_index = NULL,
  validate = TRUE,
  verbose = FALSE
)
}
\arguments{
\item{config}{A LASER configuration object or list containing outbreak data.
Must have either \code{reported_cases} field (matrix or vector) or both
\code{reported_cases} and \code{reported_deaths} fields.}

\item{location_codes}{DEPRECATED - location codes are now extracted from
the config object. This parameter is kept for backward compatibility but
will be ignored with a warning if provided.}

\item{include_deaths}{Logical; whether to include deaths column in output
if available in config. Default is FALSE since NPE is typically trained
on cases only.}

\item{time_index}{Integer vector specifying time indices. If NULL, uses
1:ncol(reported_cases) for matrix data or 1:length(reported_cases) for
vector data.}

\item{validate}{Logical; whether to validate the output data structure.
Default is TRUE. Checks for required columns and data types.}

\item{verbose}{Logical; whether to print informative messages about data
processing. Default is FALSE.}
}
\value{
A data frame in long format with columns:
\itemize{
\item \code{j} — Location identifier (character)
\item \code{t} — Time index (numeric)
\item \code{cases} — Observed case counts (numeric)
\item \code{deaths} — Observed death counts (numeric, optional)
}
}
\description{
Converts observed outbreak data from LASER configuration format into the
long-format data frame required for NPE inference. This function handles
both single and multi-location outbreak data.
}
\details{
This function standardizes the conversion from various LASER configuration
formats to the long-format data frame required by NPE functions like
\code{\link{est_npe_posterior}}. It handles:

\itemize{
\item Single location data (vector format)
\item Multi-location data (matrix format with locations as rows)
\item Optional deaths data
\item Custom location identifiers
\item Missing or NA values (converted to 0)
}

The output format matches the expected input for NPE inference functions,
with one row per location-time combination.
}
\section{Data Structure}{

\strong{Input} (LASER config format):
\itemize{
\item Matrix: \link{n_locations × n_timesteps}
\item Each row represents a location
\item Each column represents a time point
}

\strong{Output} (NPE long format):
\itemize{
\item Data frame: \link{n_locations * n_timesteps × 3-4 columns}
\item Each row represents one location-time observation
\item Columns: j (location), t (time), cases, \link{deaths}
}
}

\examples{
# Single location example
config <- list(
  reported_cases = c(10, 15, 22, 18, 12, 8, 5, 3),
  location_name = "ETH"
)
observed_data <- get_npe_observed_data(config)

# Multi-location example
config <- list(
  reported_cases = matrix(
    c(10, 15, 22, 18,  # Location 1
      5,  8, 12, 10), # Location 2
    nrow = 2, byrow = TRUE
  ),
  location_name = c("ETH", "KEN")
)
observed_data <- get_npe_observed_data(config)

# With deaths data
config <- list(
  reported_cases = matrix(c(10, 15, 22, 5, 8, 12), nrow = 2),
  reported_deaths = matrix(c(1, 2, 3, 0, 1, 1), nrow = 2),
  location_name = c("ETH", "KEN")
)
observed_data <- get_npe_observed_data(config, include_deaths = TRUE)

# Custom time indices (e.g., for specific weeks)
observed_data <- get_npe_observed_data(
  config,
  time_index = 10:17  # Weeks 10-17
)

# Config with iso_code field
config <- list(
  reported_cases = matrix(c(10, 15, 5, 8), nrow = 2),
  iso_code = c("ETH", "KEN")  # Alternative field name
)
observed_data <- get_npe_observed_data(config)

}
\seealso{
\itemize{
\item \code{\link{est_npe_posterior}} — Uses this data format for NPE inference
\item \code{\link{train_npe}} — Expects training data in this format
\item \code{\link{extract_laser_output}} — Similar function for simulation outputs
}
}
