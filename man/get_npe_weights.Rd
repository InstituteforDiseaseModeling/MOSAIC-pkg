% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/npe_utils.R
\name{get_npe_weights}
\alias{get_npe_weights}
\title{Get NPE Importance Weights}
\usage{
get_npe_weights(bfrs_results, strategy = "continuous_best", verbose = FALSE)
}
\arguments{
\item{bfrs_results}{BFRS results object containing weight columns:
\itemize{
\item weight_all: Weights for all valid simulations
\item weight_retained: Weights for retained subset
\item weight_best: Weights for best subset
\item Subset mask columns: is_valid, is_retained, is_best_subset
}}

\item{strategy}{Weight strategy:
\itemize{
\item "continuous_all": Use weight_all column (all valid simulations)
\item "binary_all": Equal weights for all simulations
\item "continuous_retained": Use weight_retained column
\item "binary_retained": Equal weights within retained subset
\item "continuous_best": Use weight_best column (DEFAULT)
\item "binary_best": Equal weights within best subset
}}

\item{verbose}{Print weight statistics}
}
\value{
Vector of normalized weights (length = nrow(bfrs_results))
}
\description{
Retrieves NPE weights from pre-calculated BFRS weight columns.
All weight calculations are performed in BFRS stage using adaptive method.
This function simply selects the appropriate column based on strategy.
}
\details{
Weight calculation is now unified in BFRS stage using adaptive Gibbs method.
This eliminates redundant recalculation and ensures consistency between
BFRS and NPE posterior estimates.

The adaptive method automatically adjusts effective AIC range to prevent
numerical underflow while maintaining discrimination among models.
}
