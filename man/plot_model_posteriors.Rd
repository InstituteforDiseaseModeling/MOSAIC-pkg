% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_model_posteriors.R
\name{plot_model_posteriors}
\alias{plot_model_posteriors}
\title{Plot Model Posterior Parameter Distributions}
\usage{
plot_model_posteriors(
  results,
  col_ll,
  col_params,
  posterior_weights = NULL,
  output_dir = NULL,
  ncol = NULL,
  show_modes = TRUE,
  show_ml = TRUE,
  filter_weights = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{results}{Data frame containing simulation results}

\item{col_ll}{Column index or name containing log-likelihood values}

\item{col_params}{Vector of parameter column indices or names to plot}

\item{posterior_weights}{Optional pre-calculated weights (if NULL, calculated internally)}

\item{output_dir}{Directory to save plots (optional)}

\item{ncol}{Number of columns in facet layout (default: 4 for global, 3 for location)}

\item{show_modes}{Logical, whether to show mode lines (default: TRUE)}

\item{show_ml}{Logical, whether to show ML estimate line (default: TRUE)}

\item{filter_weights}{Logical, whether to filter out very small weights (default: FALSE)}

\item{verbose}{Logical, whether to print messages (default: TRUE)}
}
\value{
Invisibly returns a list containing the plot objects:
\itemize{
\item \code{global}: ggplot object for global parameters
\item \code{location}: Named list of ggplot objects for each location
}
}
\description{
Creates publication-quality plots showing prior vs posterior parameter
distributions from calibration results. Uses importance sampling weights
to display unbiased posterior distributions. Generates separate plots for
global and location-specific parameters.
}
\details{
This function creates faceted plots comparing prior (unweighted) and posterior
(weighted) parameter distributions. The visual design includes:

\itemize{
\item \strong{Prior (Light Blue #457B9D)}: Histogram, density curve, and mode line
\item \strong{Posterior (Dark Blue #1D3557)}: Histogram, density curve, and mode line
\item \strong{Maximum Likelihood (Red #E63946)}: ML estimate line (optional)
\item Automatic separation of global and location-specific parameters
\item Location plots structured with initial conditions section and other parameters section
\item Clean styling with minimal theme
}

If \code{posterior_weights} is provided, those weights are used directly.
Otherwise, weights are calculated internally using \code{\link[=calc_model_posterior_distributions]{calc_model_posterior_distributions()}}.
This allows for efficient reuse of weights when creating multiple plots.

By default, \code{filter_weights = FALSE}, meaning all samples with valid (non-NA,
finite, non-negative) weights are used. This preserves the full posterior distribution.
Setting \code{filter_weights = TRUE} applies adaptive thresholds to remove very small
weights, which may be useful for computational efficiency but can distort the posterior.
}
\examples{
\dontrun{
# Basic usage - no weight filtering (default)
plot_model_posteriors(
  results = calibration_results,
  col_ll = "likelihood",
  col_params = 4:ncol(calibration_results),
  output_dir = "plots"
)

# With weight filtering for computational efficiency
plot_model_posteriors(
  results = calibration_results,
  col_ll = "likelihood", 
  col_params = 4:8,
  filter_weights = TRUE,
  output_dir = "plots"
)

# Efficient usage - reuse pre-calculated weights
posterior <- calc_model_posterior_distributions(results, "likelihood", 4:8)
plot_model_posteriors(
  results = results,
  col_ll = "likelihood",
  col_params = 4:8,
  posterior_weights = posterior$posterior_weights,
  show_ml = TRUE,
  show_modes = TRUE
)
}

}
\seealso{
\code{\link[=calc_model_posterior_distributions]{calc_model_posterior_distributions()}}, \code{\link[=plot_model_priors]{plot_model_priors()}}

Other posterior-analysis: 
\code{\link{calc_model_posterior_distributions}()}
}
\concept{posterior-analysis}
