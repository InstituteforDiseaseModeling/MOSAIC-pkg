% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/npe_train_v5_2.R
\name{train_npe_v5_2}
\alias{train_npe_v5_2}
\title{Train Neural Posterior Estimator for MOSAIC Parameters (Enhanced v5.2)}
\usage{
train_npe_v5_2(
  simulations_file,
  outputs_file,
  output_dir,
  param_names = NULL,
  simulation_filter = "complete_cases",
  architecture = "auto",
  override_spec = NULL,
  use_gpu = TRUE,
  seed = 42,
  verbose = TRUE,
  config_override = NULL,
  flow_complexity = "auto",
  autotune_one_shot = FALSE,
  transforms_ramp = list(enabled = TRUE, per_params = 25, start_at = 50, cap = 20),
  heads_min_for_largeJ = 8,
  heads_J_threshold = 25,
  t_long_threshold = 700,
  tcn_blocks_floor_longT = 7,
  tcn_longT_multiplier = 1.2,
  gradient_clip_value = 1,
  scheduler_patience = 15
)
}
\arguments{
\item{simulations_file}{Character string path to simulations parquet file}

\item{outputs_file}{Character string path to outputs parquet file}

\item{output_dir}{Character string path where trained NPE models will be saved}

\item{param_names}{Character vector of parameter names to include in training}

\item{simulation_filter}{Character vector specifying quality filters}

\item{architecture}{Character string specifying NPE architecture tier}

\item{override_spec}{Named list of architecture overrides}

\item{use_gpu}{Logical indicating whether to attempt GPU acceleration}

\item{seed}{Integer random seed for reproducible training}

\item{verbose}{Logical indicating whether to print progress messages}

\item{config_override}{Named list of configuration overrides}

\item{flow_complexity}{Character. One of "auto", "high", "max"}

\item{autotune_one_shot}{Logical. If TRUE, run diagnostics and optionally retrain once}

\item{transforms_ramp}{List controlling transform ramping with parameter count}

\item{heads_min_for_largeJ}{Integer. Minimum attention heads for many locations}

\item{heads_J_threshold}{Integer. Threshold for large-J guard activation}

\item{t_long_threshold}{Integer. Threshold for long-T guard activation}

\item{tcn_blocks_floor_longT}{Integer. Minimum TCN blocks for long sequences}

\item{tcn_longT_multiplier}{Numeric. Channel multiplier for long sequences}

\item{gradient_clip_value}{Numeric. Maximum gradient norm for clipping}

\item{scheduler_patience}{Integer. Plateau scheduler patience in epochs}
}
\value{
Named list containing training results and metadata
}
\description{
Trains a Neural Posterior Estimator (NPE) using the Lampe library with enhanced
capacity controls, automatic guards, and optional one-shot auto-tuning for
improved calibration.
}
